---
layout: post
title:  "네트워크 IPv4"
date:   2018-03-18 21:20:00 +0900
categories: jekyll update
---
### IPv4

* 네트워크 주소

  네트워크 주소는 패킷을 목적지로 라우팅하는 것에 사용되기 때문에 특히 중요하다.

* 블록 할당

  개인 인터넷 사용자에게 주소를 할당 하지않고 큰 주소 블록을 ISP에 할당한다. 블록 할당에 두 가지 제한 사항이 있다.

    1. 요청된 주소 수 N은 2의 제곱승이어야 한다.
    2. 블록 내에는 연속된 숫자의 이용 가능한 주소 공간이 있어야 한다.

      첫 번째 주소는 블록내의 주소개수로 나누어져야 한다.

  * 특수 주소

    * 디스 호스트 주소
    * 제한된 브로드캐스트 주소

      _255.255.255.255/32_ 의 주소는 제한된 브로드캐스트 주소이다. 이 주소는 호스트나 라우터가 네트워크 상의 모든 장치로 데이터그램을 보낼때 사용된다. 그러나 네트워크 외부로 패킷을 보낼 수 없다.

    * 루프백 주소

      _127.0.0.0/8_ 의 블록은 루프백 주소이다. 내컴퓨터를 테스트용 서버로 설정한다.

    * 사설 주소

      주소 고갈 문제를 해결하기 위한 주소이다. 사설 주소로 라우팅 할 수 없어서 인터넷 사용시 공인 IP로 바꿔준다.

    * 멀티캐스트 주소

      224.0.0.0/4는 멀티캐스트 주소로 예약된 블록이다.

* 네트워크 주소 변환(NAT)

    사설IP주소와 공인IP주간 매핑 기능, 네트워크 외부와 통신 할때 공인 IP는 하나만 필요하다. 네트워크 내의 노드를 식별하기 위해 포트 번호를 사용한다.

    <a href="https://www.youtube.com/watch?v=QBqPzHEDzvo
" target="_blank_"> NAT youtube animation </a>

* 동적 호스트 구성 DHCP 메시지 형식

  UDP


  |   1. DHCPDISCOVER       |client->server|
  |:----------:|:-------:|:-----:|
  |transaction ID| 1001 |교환 정보|
  |Lease time||IP 할당 시간|
  |client IP| | |
  |Your IP||서버로부터 제안된 주소|
  |serve IP| | 서버 IP|
  |Sourve port : 68| Destination port : 67||
  |Source IP|0.0.0.0|아직 할당 받지 않았다. 자기자신|
  |Destination IP|255.255.255.255|브로드 캐스트|

  |   2. DHCPOFFER       |server->client|
  |:----------:|:-------:|:-----:|
  |transaction ID| 1001 |교환 정보|
  |Lease time|3600|IP 할당 시간|
  |client IP| | |
  |Your IP|12.13.14.15|서버로부터 제안된 주소|
  |serve IP|12.13.14.0 | 서버 IP|
  |**Sourve port : 68**| **Destination port : 67** ||
  |Source IP|12.13.14.0|서버주소|
  |Destination IP|255.255.255.255|브로드 캐스트|


  |   3. DHCPREQUEST       |client->server|
  |:----------:|:-------:|:-----:|
  |transaction ID| 1001 |교환 정보|
  |Lease time|3600|IP 할당 시간|
  |client IP|12.13.14.15 | 사용하겠다. |
  |Your IP|||
  |serve IP|12.13.14.0 | 서버 IP|
  |**Sourve port : 68**| **Destination port : 67** ||
  |Source IP|12.13.14.15||
  |Destination IP|255.255.255.255|DHCP서버가 여러대 일수 있기 때문에 브로드 캐스트|

  |   4. DHCPACK       |server->client|
  |:----------:|:-------:|:-----:|
  |transaction ID| 1001 |교환 정보|
  |Lease time|3600|IP 할당 시간|
  |client IP| |  |
  |Your IP|12.13.14.15||
  |serve IP|12.13.14.0 | 서버 IP|
  |**Sourve port : 68**| **Destination port : 67** ||
  |Source IP|12.13.14.0||
  |Destination IP|255.255.255.255|DHCP서버가 여러대 일수 있기 때문에 브로드 캐스트|

  * IP패킷 포워딩

    * 목적지 주소에 기반을 둔 포워딩

      라우팅테이블의 크기를 줄이기위해, 검색 시간을 줄인다, 메모리양을 줄인다. prefix가 큰거부터 포워딩 테이블에 채워 나간다.
