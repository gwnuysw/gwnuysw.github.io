---
layout: post
title:  "네트워크층 프로토콜"
date:   2018-03-20 21:20:00 +0900
categories: jekyll update
---
### 인터넷 프로토콜(IP)

* 데이터 그램 형식

  IP가 사용하는 패킷을 데이터그램이라 한다. 데이터 그램은 가변 길이의 패킷으로 헤더와 페이로드로 이루어져있다. 헤더는 20~60바이트의 길이를 가진다. 각 필드는 다음과 같다.

  * 버전 숫자

    IP프로토콜 버전을 정의 한다.

  * 헤더 길이
  * 서비스 유형
  * 전체 길이

    16비트의 필드로 IP 데이터 그램의 전체 바이트 수를 정의 한다.

  * 식별자
  * 플래그
  * 단편화 오프셋
  * 생존 시간

    패킷이 살아 있을 수 있는 시간, 라우터를 거쳐 갈 수 있는 수, 라우터를 거칠 때 마다 줄어든다.
  * IP프로토콜
  * 헤더 체크섬
  * 근원지와 목적지 주소
  * 옵션
  * 페이로드로


* 단편화(fragmentation)

  단편화는 소스호스트와 라우터에서 수행되며 조합은 목적지 호스트에서 수행한다.

  * 최대 전송 단위 (MTU)

    페이로드의 최대 길이를 MTU라고 한다. 일반적으로 이더넷의 경우 _1,500바이트_ 이다. 네트워크 마다 MTU크기가 다 다른데 큰 곳에서 작은곳으로 패킷이 넘어가면서 패킷의 크기가 안맞을때 데이터 그램을 **단편화(fragmentation)** 해야 한다.

  * 단편화에 관련된 필

    * 식별자

      데이터그램이 여러개로 단편화 되더라도 식별자 필드의 값은 모두 동일하므로 목적지에서 조합 할 수 있다.

    * 플래그

      3비트로 구성 되는데, 가장 왼쪽 필드는 사용 하지 않는다. 두 번째 1비트(D비트)는 단편화 금지 필드이다. 만약 값이 1이라면 단편화 해서는 안된다. 세 번째 비트(M비트)는 추가 단편화 비트 이다. 만약 값이 1이라면 뒤에 다른 조각이 더 있다는 뜻이다.

    * 단편화 오프셋

      해당 단편에서 8바이트 단위 상대적인 위치를 나타낸다.

* 옵션

  * 엄격한 근원지 경로

    반드시 거쳐야 하는 라우터를 명시한다.

  * 유연한 근원지 경로

    엄격한 근원지 경로보다 덜 엄격하다.
